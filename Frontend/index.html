<!DOCTYPE html>
<html lang=""en>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" 
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <style>
            [v-cloak] {
                display: none;
            }

            body {
                padding-top: 40px;
                padding-bottom: 40px;
            }
            #app {
                max-width: 500px;
            }
        </style>
    </head>
    <body> 
        <div class="container" id = "app" v-cloak>

            <!-- If results is not null, return appropriate response-->
            <div v-if="results">
                <h2 v-if="results.predictedTagName === 'With Mask'">ðŸ˜· Masked</h2>
                <h2 v-if="results.predictedTagName === 'Without Mask'">ðŸ˜Š Unmasked</h2>
            </div>
            
            <!-- display image from base64 decode-->
            <img v-if:src="'data:image/jpeg;base64,'+ results.img"/>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/superagent/3.5.2/superagent.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.2.6/vue.min.js"></script>
        <script>
            var apiBaseUrl = 'http://localhost:7071'
            
            var app = new Vue({
                el: '#app',
                data: function(){
                    return {
                        url: '',
                        results: null,
                        waiting: false
                    }
                },
                methods: {
                    onSubmit: function (event) {
                    this.waiting = true;
                    superagent
                        .get(apiBaseUrl + '/api/classify')
                        .end(function (err, res) {
                        this.waiting = false;
                        if (err) {
                            this.results = null;
                            alert("An error has occurred");
                        } else {
                            this.results = res.body;
                        }
                        }.bind(this));
                    }
                },
                beforeMount(){
                    this.onSubmit()
                }
            });
        </script>
    </body>
</html>